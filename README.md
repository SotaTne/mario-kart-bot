# this is discord bot

## プロジェクトの起動と実行方法

### ローカル環境で動かす時

```bash
npm install
npm run dev
```

### 本番環境で動かす時(Githubのmainブランチと紐付けようと思うので、どうしてもの時以外使わない)

```bash
npm run deploy
```

## 環境変数について

### 今回は、Cloudflareを使うので、

```bash
cat .env.example > .dev.vars
```

## フォルダ構造について

### discord-actions

- ディスコードでのコマンドやイベントなどのことについて書く
- コントローラー層やView層と同等の`ゲートウェイ`層

### controller

- エンドポイントの処理を行うところ
- 一番中心(domain層) > ユーザーから見た動き(UseCase層) > コントローラー層となっている

### domain**

- 一番中心
- 内部で扱うデータや、一番外側のフレームワークやDBで使うインターフェースを記述する
- **entity**
  - DBや外部のものに依存しないようにこのアプリ独自のデータ構造を定義する
  - classをより変更にクローズで参照にオープンな形にしておく
- **interface**
  - DBや、外部の関数のインターフェースを記述する
  - こうすることにより、外部に依存しずに他の場所でも外部の機能を使える
  - [インフラ層](#infra)のインターフェースを書く

### usecase

- ユーザーから見た時の動きを`ゲートウェイ層`の機能を使い記述する

### infra

- 主に、データベースや一部のフレームワークなど外部の機能を使う`ゲートウェイ層`
- データベースへの保存や、セッションの保存なども担当する
- 機能ごとに、`client`/`repository`などと分けたりする
- 今回、`discord-action`と分けた理由は、機能や、依存関係がめちゃくちゃになりそうだったため
- 基本的に、一つのファイルは、一つの機能だけを提供して、**内部の機能に依存しない**ようにする
- ようは、単体で動くようにする

### guard

- [controller層](#controller)と非常に似ているが、その中でも認証して次の処理に行くか行かないかのミドルウェア的役割
- ほぼ[controller層](#controller)と同じように使ってもらっていい

### shared

- 環境や、依存など関係なく使えるもの
- 型や、副作用のない関数をかく
  
### config

- より、環境の内容(urlや定数)や、それに非常に近いものを書く
- [shared](#shared)とほぼ変わらないので、ここは感覚
